                                                                                        QUERY PLAN                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=125509169.53..125509169.95 rows=170 width=136) (actual time=1007322.649..1014377.123 rows=5 loops=1)
   Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
   Sort Method: quicksort  Memory: 25kB
   ->  Finalize GroupAggregate  (cost=125508721.07..125509163.23 rows=170 width=136) (actual time=1007197.745..1014376.888 rows=5 loops=1)
         Group Key: nation.n_name
         ->  Gather Merge  (cost=125508721.07..125509147.08 rows=1870 width=136) (actual time=1007157.251..1014376.564 rows=60 loops=1)
               Workers Planned: 11
               Workers Launched: 11
               ->  Partial GroupAggregate  (cost=125507720.86..125507912.32 rows=170 width=136) (actual time=1006771.366..1006936.639 rows=5 loops=12)
                     Group Key: nation.n_name
                     ->  Sort  (cost=125507720.86..125507758.72 rows=15147 width=116) (actual time=1006729.157..1006777.389 rows=606859 loops=12)
                           Sort Key: nation.n_name
                           Sort Method: quicksort  Memory: 52390kB
                           Worker 0:  Sort Method: quicksort  Memory: 52382kB
                           Worker 1:  Sort Method: quicksort  Memory: 51990kB
                           Worker 2:  Sort Method: quicksort  Memory: 52292kB
                           Worker 3:  Sort Method: quicksort  Memory: 52110kB
                           Worker 4:  Sort Method: external merge  Disk: 29544kB
                           Worker 5:  Sort Method: external merge  Disk: 29552kB
                           Worker 6:  Sort Method: quicksort  Memory: 52232kB
                           Worker 7:  Sort Method: external merge  Disk: 29536kB
                           Worker 8:  Sort Method: quicksort  Memory: 51747kB
                           Worker 9:  Sort Method: quicksort  Memory: 52016kB
                           Worker 10:  Sort Method: quicksort  Memory: 52268kB
                           ->  Nested Loop  (cost=249893.11..125506669.14 rows=15147 width=116) (actual time=915.711..1005362.236 rows=606859 loops=12)
                                 Join Filter: (customer.c_nationkey = supplier.s_nationkey)
                                 Rows Removed by Join Filter: 14561494
                                 ->  Nested Loop  (cost=249892.54..124310652.14 rows=493689 width=128) (actual time=904.897..848002.707 rows=15168353 loops=12)
                                       ->  Parallel Hash Join  (cost=249891.95..123274288.62 rows=3208643 width=132) (actual time=904.312..596503.852 rows=99985962 loops=12)
                                             Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                             ->  Parallel Seq Scan on lineitem  (cost=0.00..120972469.47 rows=545469347 width=24) (actual time=0.493..323172.940 rows=499999142 loops=12)
                                             ->  Parallel Hash  (cost=249744.90..249744.90 rows=11764 width=116) (actual time=903.587..904.091 rows=166635 loops=12)
                                                   Buckets: 2097152 (originally 65536)  Batches: 1 (originally 1)  Memory Usage: 173408kB
                                                   ->  Hash Join  (cost=24.31..249744.90 rows=11764 width=116) (actual time=0.349..696.016 rows=166635 loops=12)
                                                         Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..242103.24 rows=1999924 width=8) (actual time=0.218..628.120 rows=833333 loops=12)
                                                         ->  Hash  (cost=24.29..24.29 rows=1 width=108) (actual time=0.117..0.207 rows=5 loops=12)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=12.14..24.29 rows=1 width=108) (actual time=0.111..0.176 rows=5 loops=12)
                                                                     Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation  (cost=0.00..11.70 rows=170 width=112) (actual time=0.040..0.066 rows=25 loops=12)
                                                                     ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.054..0.057 rows=1 loops=12)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..12.12 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=12)
                                                                                 Filter: (r_name = 'ASIA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                                       ->  Memoize  (cost=0.59..2.44 rows=1 width=12) (actual time=0.002..0.002 rows=0 loops=1199831542)
                                             Cache Key: lineitem.l_orderkey
                                             Cache Mode: logical
                                             Hits: 31568263  Misses: 68810601  Evictions: 67456250  Overflows: 0  Memory Usage: 104857kB
                                             Worker 0:  Hits: 31544623  Misses: 68766846  Evictions: 67412960  Overflows: 0  Memory Usage: 104857kB
                                             Worker 1:  Hits: 31294165  Misses: 68214122  Evictions: 66860061  Overflows: 0  Memory Usage: 104857kB
                                             Worker 2:  Hits: 31443934  Misses: 68545381  Evictions: 67191287  Overflows: 0  Memory Usage: 104857kB
                                             Worker 3:  Hits: 31431119  Misses: 68532290  Evictions: 67177539  Overflows: 0  Memory Usage: 104857kB
                                             Worker 4:  Hits: 31567257  Misses: 68809252  Evictions: 67455534  Overflows: 0  Memory Usage: 104857kB
                                             Worker 5:  Hits: 31650256  Misses: 68996276  Evictions: 67641850  Overflows: 0  Memory Usage: 104857kB
                                             Worker 6:  Hits: 31390587  Misses: 68431828  Evictions: 67077044  Overflows: 0  Memory Usage: 104857kB
                                             Worker 7:  Hits: 31634847  Misses: 68971016  Evictions: 67616745  Overflows: 0  Memory Usage: 104857kB
                                             Worker 8:  Hits: 31109137  Misses: 67820302  Evictions: 66466478  Overflows: 0  Memory Usage: 104857kB
                                             Worker 9:  Hits: 31226529  Misses: 68078812  Evictions: 66724280  Overflows: 0  Memory Usage: 104857kB
                                             Worker 10:  Hits: 31440988  Misses: 68553111  Evictions: 67198717  Overflows: 0  Memory Usage: 104857kB
                                             ->  Index Scan using orders_pkey on orders  (cost=0.58..2.43 rows=1 width=12) (actual time=0.003..0.003 rows=0 loops=822529837)
                                                   Index Cond: (o_orderkey = lineitem.l_orderkey)
                                                   Filter: ((o_orderdate >= '1994-01-01'::date) AND (o_orderdate < '1995-01-01 00:00:00'::timestamp without time zone))
                                                   Rows Removed by Filter: 1
                                 ->  Index Scan using customer_pkey on customer  (cost=0.57..2.41 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=182020233)
                                       Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 11.298 ms
 Execution Time: 1014428.913 ms
(69 rows)

