                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize GroupAggregate  (cost=121685198.26..121690728.27 rows=4800 width=70) (actual time=1028766.990..1029162.540 rows=146 loops=1)
   Group Key: departments.department, orders.order_hour_of_day
   ->  Gather Merge  (cost=121685198.26..121690608.27 rows=9600 width=70) (actual time=1028761.161..1029162.424 rows=438 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial GroupAggregate  (cost=121684198.24..121688500.17 rows=4800 width=70) (actual time=1028743.501..1029130.512 rows=146 loops=3)
               Group Key: departments.department, orders.order_hour_of_day
               ->  Sort  (cost=121684198.24..121685261.72 rows=425393 width=62) (actual time=1028741.843..1028991.107 rows=1939700 loops=3)
                     Sort Key: departments.department, orders.order_hour_of_day DESC
                     Sort Method: external merge  Disk: 47600kB
                     Worker 0:  Sort Method: external merge  Disk: 45336kB
                     Worker 1:  Sort Method: external merge  Disk: 42840kB
                     ->  Hash Join  (cost=1136.99..121628432.32 rows=425393 width=62) (actual time=8.503..1027451.027 rows=1939700 loops=3)
                           Hash Cond: (products.department_id = departments.department_id)
                           ->  Nested Loop  (cost=1106.74..121627280.15 rows=425393 width=8) (actual time=8.430..1026729.831 rows=1939700 loops=3)
                                 ->  Hash Join  (cost=1106.16..117995324.19 rows=425393 width=12) (actual time=8.227..837985.181 rows=1939700 loops=3)
                                       Hash Cond: (order_products.product_id = products.product_id)
                                       ->  Parallel Seq Scan on order_products  (cost=0.00..106896377.60 rows=4227388160 width=16) (actual time=0.125..645164.263 rows=3381910600 loops=3)
                                       ->  Hash  (cost=1106.10..1106.10 rows=5 width=12) (actual time=7.694..7.704 rows=26 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on products  (cost=0.00..1106.10 rows=5 width=12) (actual time=0.642..7.692 rows=26 loops=3)
                                                   Filter: ((product_name)::text ~~ '%green%'::text)
                                                   Rows Removed by Filter: 49662
                                 ->  Index Scan using orders_pkey on orders  (cost=0.57..8.54 rows=1 width=12) (actual time=0.097..0.097 rows=1 loops=5819100)
                                       Index Cond: (order_id = order_products.order_id)
                           ->  Hash  (cost=19.00..19.00 rows=900 width=62) (actual time=0.054..0.055 rows=21 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on departments  (cost=0.00..19.00 rows=900 width=62) (actual time=0.045..0.046 rows=21 loops=3)
 Planning Time: 11.702 ms
 Execution Time: 1029172.548 ms
(30 rows)

