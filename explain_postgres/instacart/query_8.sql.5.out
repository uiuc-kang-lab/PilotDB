                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize GroupAggregate  (cost=141411486.36..141493856.42 rows=24 width=12) (actual time=1205438.322..1215515.791 rows=12 loops=1)
   Group Key: orders.order_hour_of_day
   ->  Gather Merge  (cost=141411486.36..141493855.76 rows=48 width=20) (actual time=1205401.037..1215515.752 rows=36 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial GroupAggregate  (cost=141410486.34..141492850.19 rows=24 width=20) (actual time=1205326.387..1209013.478 rows=12 loops=3)
               Group Key: orders.order_hour_of_day
               ->  Sort  (cost=141410486.34..141426959.06 rows=6589089 width=20) (actual time=1205253.000..1207123.643 rows=25267900 loops=3)
                     Sort Key: orders.order_hour_of_day
                     Sort Method: external merge  Disk: 813672kB
                     Worker 0:  Sort Method: external merge  Disk: 814152kB
                     Worker 1:  Sort Method: external merge  Disk: 809488kB
                     ->  Hash Join  (cost=16473733.05..140393961.73 rows=6589089 width=20) (actual time=1160477.366..1196322.998 rows=25267900 loops=3)
                           Hash Cond: (products.aisle_id = aisles.aisle_id)
                           ->  Parallel Hash Join  (cost=16473729.04..140376114.32 rows=6589089 width=8) (actual time=1160477.284..1193333.367 rows=25267900 loops=3)
                                 Hash Cond: (order_products.order_id = orders.order_id)
                                 ->  Hash Join  (cost=1136.99..122938244.02 rows=18802382 width=12) (actual time=19.101..1014230.109 rows=73923800 loops=3)
                                       Hash Cond: (order_products.product_id = products.product_id)
                                       ->  Parallel Seq Scan on order_products  (cost=0.00..106896377.60 rows=4227388160 width=16) (actual time=0.931..789000.081 rows=3381910600 loops=3)
                                       ->  Hash  (cost=1134.22..1134.22 rows=221 width=12) (actual time=18.149..18.157 rows=907 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 47kB
                                             ->  Hash Join  (cost=21.30..1134.22 rows=221 width=12) (actual time=0.126..18.020 rows=907 loops=3)
                                                   Hash Cond: (products.department_id = departments.department_id)
                                                   ->  Seq Scan on products  (cost=0.00..981.88 rows=49688 width=16) (actual time=0.019..14.830 rows=49688 loops=3)
                                                   ->  Hash  (cost=21.25..21.25 rows=4 width=4) (actual time=0.099..0.102 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on departments  (cost=0.00..21.25 rows=4 width=4) (actual time=0.093..0.095 rows=1 loops=3)
                                                               Filter: ((department)::text = 'meat seafood'::text)
                                                               Rows Removed by Filter: 20
                                 ->  Parallel Hash  (cost=13865590.00..13865590.00 rows=149975844 width=12) (actual time=122117.841..122117.842 rows=119482100 loops=3)
                                       Buckets: 131072  Batches: 8192  Memory Usage: 3136kB
                                       ->  Parallel Seq Scan on orders  (cost=0.00..13865590.00 rows=149975844 width=12) (actual time=0.092..94424.114 rows=119482100 loops=3)
                                             Filter: (order_hour_of_day < 12)
                                             Rows Removed by Filter: 222626200
                           ->  Hash  (cost=2.34..2.34 rows=134 width=20) (actual time=0.055..0.056 rows=134 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                 ->  Seq Scan on aisles  (cost=0.00..2.34 rows=134 width=20) (actual time=0.012..0.020 rows=134 loops=3)
 Planning Time: 11.643 ms
 Execution Time: 1215701.590 ms
(39 rows)

