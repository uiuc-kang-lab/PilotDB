SELECT l_returnflag, l_linestatus, SUM(l_quantity) / sample_rate AS sum_qty, SUM(l_extendedprice) / sample_rate AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) / sample_rate AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) / sample_rate AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) / sample_rate AS count_order FROM lineitem sampling_method WHERE l_shipdate <= CAST('1998-12-01' AS DATE) - INTERVAL '90' DAY GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus