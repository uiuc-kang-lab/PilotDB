                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize GroupAggregate  (cost=121685198.26..121690728.27 rows=4800 width=70) (actual time=992272.059..992669.657 rows=146 loops=1)
   Group Key: departments.department, orders.order_hour_of_day
   ->  Gather Merge  (cost=121685198.26..121690608.27 rows=9600 width=70) (actual time=992262.153..992669.565 rows=438 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial GroupAggregate  (cost=121684198.24..121688500.17 rows=4800 width=70) (actual time=992248.858..992639.728 rows=146 loops=3)
               Group Key: departments.department, orders.order_hour_of_day
               ->  Sort  (cost=121684198.24..121685261.72 rows=425393 width=62) (actual time=992247.198..992502.517 rows=1939700 loops=3)
                     Sort Key: departments.department, orders.order_hour_of_day DESC
                     Sort Method: external merge  Disk: 45336kB
                     Worker 0:  Sort Method: external merge  Disk: 45288kB
                     Worker 1:  Sort Method: external merge  Disk: 45152kB
                     ->  Hash Join  (cost=1136.99..121628432.32 rows=425393 width=62) (actual time=8.269..990958.100 rows=1939700 loops=3)
                           Hash Cond: (products.department_id = departments.department_id)
                           ->  Nested Loop  (cost=1106.74..121627280.15 rows=425393 width=8) (actual time=8.197..990205.456 rows=1939700 loops=3)
                                 ->  Hash Join  (cost=1106.16..117995324.19 rows=425393 width=12) (actual time=8.004..804106.016 rows=1939700 loops=3)
                                       Hash Cond: (order_products.product_id = products.product_id)
                                       ->  Parallel Seq Scan on order_products  (cost=0.00..106896377.60 rows=4227388160 width=16) (actual time=0.128..625415.524 rows=3381910600 loops=3)
                                       ->  Hash  (cost=1106.10..1106.10 rows=5 width=12) (actual time=7.451..7.452 rows=26 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on products  (cost=0.00..1106.10 rows=5 width=12) (actual time=0.643..7.440 rows=26 loops=3)
                                                   Filter: ((product_name)::text ~~ '%green%'::text)
                                                   Rows Removed by Filter: 49662
                                 ->  Index Scan using orders_pkey on orders  (cost=0.57..8.54 rows=1 width=12) (actual time=0.095..0.095 rows=1 loops=5819100)
                                       Index Cond: (order_id = order_products.order_id)
                           ->  Hash  (cost=19.00..19.00 rows=900 width=62) (actual time=0.054..0.054 rows=21 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on departments  (cost=0.00..19.00 rows=900 width=62) (actual time=0.044..0.046 rows=21 loops=3)
 Planning Time: 11.686 ms
 Execution Time: 992679.360 ms
(30 rows)

