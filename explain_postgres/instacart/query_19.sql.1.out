                                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=184851162.55..184851162.56 rows=1 width=8) (actual time=1006593.380..1006597.338 rows=1 loops=1)
   ->  Gather  (cost=184851162.33..184851162.54 rows=2 width=8) (actual time=1006593.161..1006597.332 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=184850162.33..184850162.34 rows=1 width=8) (actual time=1006590.242..1006590.251 rows=1 loops=3)
               ->  Hash Join  (cost=1379.50..184787492.66 rows=25067867 width=0) (actual time=14.762..1005377.240 rows=17648600 loops=3)
                     Hash Cond: (order_products.product_id = products.product_id)
                     Join Filter: ((((products.product_name)::text ~~ '%Noddle%'::text) AND (order_products.add_to_cat_order >= 1) AND (order_products.add_to_cat_order <= 3)) OR (((products.product_name)::text ~~ '%Rice%'::text) AND (order_products.add_to_cat_order >= 3) AND (order_products.add_to_cat_order <= 5)) OR (((products.product_name)::text ~~ '%Bread%'::text) AND (order_products.add_to_cat_order >= 5) AND (order_products.add_to_cat_order <= 8)))
                     Rows Removed by Join Filter: 27485900
                     ->  Parallel Seq Scan on order_products  (cost=0.00..180875670.40 rows=1489688612 width=12) (actual time=0.136..904970.607 rows=1338569600 loops=3)
                           Filter: ((reordered = 1) AND (((add_to_cat_order >= 1) AND (add_to_cat_order <= 3)) OR ((add_to_cat_order >= 3) AND (add_to_cat_order <= 5)) OR ((add_to_cat_order >= 5) AND (add_to_cat_order <= 8))))
                           Rows Removed by Filter: 2043341000
                     ->  Hash  (cost=1354.54..1354.54 rows=1997 width=39) (actual time=14.496..14.503 rows=1680 loops=3)
                           Buckets: 2048  Batches: 1  Memory Usage: 136kB
                           ->  Seq Scan on products  (cost=0.00..1354.54 rows=1997 width=39) (actual time=0.025..14.256 rows=1680 loops=3)
                                 Filter: (((product_name)::text ~~ '%Noddle%'::text) OR ((product_name)::text ~~ '%Rice%'::text) OR ((product_name)::text ~~ '%Bread%'::text))
                                 Rows Removed by Filter: 48008
 Planning Time: 9.091 ms
 Execution Time: 1006597.698 ms
(19 rows)

