                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=90836497.06..90836508.56 rows=4599 width=34) (actual time=470448.246..470508.567 rows=4 loops=1)
   Sort Key: dates.d_year, (sum(lineorder.lo_revenue)) DESC
   Sort Method: quicksort  Memory: 25kB
   ->  GroupAggregate  (cost=90835547.43..90836217.28 rows=4599 width=34) (actual time=470447.128..470508.531 rows=4 loops=1)
         Group Key: customer.c_city, supplier.s_city, dates.d_year
         ->  Gather Merge  (cost=90835547.43..90836125.30 rows=4599 width=30) (actual time=470446.676..470508.058 rows=5041 loops=1)
               Workers Planned: 11
               Workers Launched: 11
               ->  Sort  (cost=90834547.21..90834548.26 rows=418 width=30) (actual time=470440.095..470440.124 rows=420 loops=12)
                     Sort Key: customer.c_city, supplier.s_city, dates.d_year
                     Sort Method: quicksort  Memory: 49kB
                     Worker 0:  Sort Method: quicksort  Memory: 49kB
                     Worker 1:  Sort Method: quicksort  Memory: 48kB
                     Worker 2:  Sort Method: quicksort  Memory: 47kB
                     Worker 3:  Sort Method: quicksort  Memory: 47kB
                     Worker 4:  Sort Method: quicksort  Memory: 46kB
                     Worker 5:  Sort Method: quicksort  Memory: 48kB
                     Worker 6:  Sort Method: quicksort  Memory: 47kB
                     Worker 7:  Sort Method: quicksort  Memory: 47kB
                     Worker 8:  Sort Method: quicksort  Memory: 45kB
                     Worker 9:  Sort Method: quicksort  Memory: 48kB
                     Worker 10:  Sort Method: quicksort  Memory: 48kB
                     ->  Hash Join  (cost=567715.27..90834529.01 rows=418 width=30) (actual time=8015.895..470438.818 rows=420 loops=12)
                           Hash Cond: (lineorder.lo_orderdate = dates.d_datekey)
                           ->  Parallel Hash Join  (cost=567641.93..90834322.23 rows=34472 width=30) (actual time=7299.700..470428.136 rows=31975 loops=12)
                                 Hash Cond: (lineorder.lo_suppkey = supplier.s_suppkey)
                                 ->  Parallel Hash Join  (cost=532092.22..90782435.00 rows=4333688 width=23) (actual time=6803.780..468782.292 rows=3978959 loops=12)
                                       Hash Cond: (lineorder.lo_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on lineorder  (cost=0.00..88197560.73 rows=545482473 width=16) (actual time=0.336..411668.012 rows=499999142 loops=12)
                                       ->  Parallel Hash  (cost=531595.71..531595.71 rows=39721 width=15) (actual time=6802.519..6802.522 rows=19925 loops=12)
                                             Buckets: 262144  Batches: 1  Memory Usage: 13472kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..531595.71 rows=39721 width=15) (actual time=1.401..6791.121 rows=19925 loops=12)
                                                   Filter: (((c_city)::text = 'UNITED KI1'::text) OR ((c_city)::text = 'UNITED KI5'::text))
                                                   Rows Removed by Filter: 2480075
                                 ->  Parallel Hash  (cost=35500.00..35500.00 rows=3977 width=15) (actual time=475.891..475.894 rows=1339 loops=12)
                                       Buckets: 16384  Batches: 1  Memory Usage: 1024kB
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..35500.00 rows=3977 width=15) (actual time=1.067..475.214 rows=1339 loops=12)
                                             Filter: (((s_city)::text = 'UNITED KI1'::text) OR ((s_city)::text = 'UNITED KI5'::text))
                                             Rows Removed by Filter: 165327
                           ->  Hash  (cost=72.95..72.95 rows=31 width=8) (actual time=0.451..0.453 rows=31 loops=12)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on dates  (cost=0.00..72.95 rows=31 width=8) (actual time=0.391..0.443 rows=31 loops=12)
                                       Filter: ((d_yearmonth)::text = 'Dec1997'::text)
                                       Rows Removed by Filter: 2525
 Planning Time: 8.849 ms
 Execution Time: 470508.735 ms
(46 rows)

